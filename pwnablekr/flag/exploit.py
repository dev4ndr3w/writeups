#!/usr/bin/env python
# sudo apt install upx
# this exploit doesn't work anymore, so if you wanna clear this challenge, you can find flag with gdb

from pwn import *
import os

TARGET = ELF(os.environ["PWD"]+"/flag")
os.system("upx -d {}".format(TARGET.path))

rodata = 0x496620
offset_flag = 0x08 

processHandle = process(executable=TARGET.path, argv=[TARGET.path])
try:
	print(processHandle.leak(rodata+offset_flag, 41))
except:
    log.info("Failed to exploit! please try again.")
    exit(-1)
